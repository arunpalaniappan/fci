names(wheat_state)[2] = "wheat_allotment"
rice_wheat = inner_join(rice_state, wheat_state, by=c('State.UT'))
rice_wheat$perc_rice = rice_wheat$rice_allotment / (rice_wheat$rice_allotment + rice_wheat$wheat_allotment)
rice_wheat$perc_wheat = rice_wheat$wheat_allotment / (rice_wheat$rice_allotment + rice_wheat$wheat_allotment)
#Total allotment offtake
all_off = inner_join(rice, wheat, by=c('State.UT', 'year'))
all_off$offtake = all_off$offtake.x + all_off$offtake.y
all_off$allotment = all_off$allotment.x + all_off$allotment.y
all_off$zone = all_off$zone.x
all_off$offtake.x = all_off$offtake.y = all_off$zone.x = NULL
all_off$allotment.x = all_off$allotment.y = all_off$zone.y = NULL
all_off$utilisation_ratio = all_off$offtake / all_off$allotment
all_off = remove_outliers(all_off, c("allotment", "offtake", "utilisation_ratio"))
#rice$grain = "rice"
#wheat$grain = "wheat"
#rice_wheat = rbind(rice, wheat)
state_ao = read.xlsx("state_ao.xlsx")
#Getting road length data
road_l <- read.xlsx("Road Length 2010-16.XLSX")
road_l <- gather(road_l, key='year', value='length', -one_of('State.UT'))
road_l <- road_l[complete.cases(road_l),]
road_l$year = as.numeric(road_l$year)
road_l$log_length = log(road_l$length)
road_l <- remove_outliers(road_l, c("length", "log_length"))
#Getting road density data
roadd_sqkm <- read.xlsx("Road Density per sq km 2010-16.xlsx")
roadd_sqkm <- gather(roadd_sqkm, key='year', value='length', -one_of('State.UT'))
roadd_sqkm <- roadd_sqkm[complete.cases(roadd_sqkm),]
roadd_sqkm$log_density = log(roadd_sqkm$length)
roadd_sqkm$year = as.numeric(roadd_sqkm$year)
roadd_sqkm <- remove_outliers(roadd_sqkm, c("length", "log_density"))
#Getting state highway length
sh_l <- read.xlsx("SH Length 2011-16.xlsx")
sh_l <- gather(sh_l, key='year', value='length', -one_of('State.UT'))
sh_l <- sh_l[complete.cases(sh_l),]
sh_l$log_length = log(sh_l$length)
sh_l$year = as.numeric(sh_l$year)
sh_l <- remove_outliers(sh_l, names(sh_l)[-1:-2])
#Getting state highway density
sh_d <- read.xlsx("SH Density 2011-16.xlsx")
sh_d <- gather(sh_d, key='year', value='density', -one_of('State.UT'))
sh_d <- sh_d[complete.cases(sh_d),]
sh_d$log_density = log(sh_d$density)
sh_d$year = as.numeric(sh_d$year)
sh_d <- remove_outliers(sh_d, names(sh_d)[-1:-2])
#Getting railway length data
rw_l <- read.xlsx("Railway Length 2011-17.xlsx")
rw_l <- gather(rw_l, key='year', value='length', -one_of('State.UT'))
rw_l <- rw_l[complete.cases(rw_l),]
rw_l$log_length = log(rw_l$length)
rw_l$year = as.numeric(rw_l$year)
rw_l <- remove_outliers(rw_l, names(rw_l)[-1:-2])
#Getting railway density data
rw_d <- read.xlsx("Railway Density per sq km 2011-17.xlsx")
rw_d <- gather(rw_d, key='year', value='density', -one_of('State.UT'))
rw_d <- rw_d[complete.cases(rw_d),]
rw_d$log_density = log(rw_d$density)
rw_d$year = as.numeric(rw_d$year)
#Getting GSDP data
gsdp <- read.xlsx("GSDP Current Price 2011-20.xlsx")
gsdp = gather(gsdp, key='year', value='gsdp', -one_of('State.UT'))
gsdp$year = substr(gsdp$year, 1, 4)
gsdp = gsdp[complete.cases(gsdp),]
gsdp$log_gsdp = log(gsdp$gsdp)
gsdp$year = as.numeric(gsdp$year)
#Aggregating of years to get state wise data
state_total_ao = all_off %>% group_by(State.UT) %>%
summarise(allotment = sum(allotment), offtake = sum(offtake))
#Aggreagating of states to get year wise data
year_total_ao = all_off %>% group_by(year) %>%
summarise(allotment = sum(allotment), offtake = sum(offtake))
## Making district office count
#The below code is for making district wise offtake allotment
add_row_entries_sao <- function(sao, idx1, idx2)
{
sao[idx1,]$allotment = sao[idx1, ]$allotment + sao[idx2, ]$allotment
sao[idx1,]$offtake = sao[idx1, ]$offtake + sao[idx2, ]$offtake
sao = sao[-idx2, ]
return (sao)
}
make_district_office_count <- function(sao, fci_do_count)
{
sao = add_row_entries_sao(sao, which(sao$State.UT == "PUNJAB"), which(sao$State.UT == "CHANDIGARH"))
sao = add_row_entries_sao(sao, which(sao$State.UT == "TAMILNADU"), which(sao$State.UT == "PONDICHERRY"))
sao = add_row_entries_sao(sao, which(sao$State.UT == "ANDHRA PR"), which(sao$State.UT == "TELANGANA"))
sao = add_row_entries_sao(sao, which(sao$State.UT == "ANDHRA PR"), which(sao$State.UT == "A&N ISLANDS"))
sao = add_row_entries_sao(sao, which(sao$State.UT == "KARNATAKA"), which(sao$State.UT == "LAKSHADWEEP"))
sao = add_row_entries_sao(sao, which(sao$State.UT == "WEST BENGAL"), which(sao$State.UT == "SIKKIM"))
sao = add_row_entries_sao(sao, which(sao$State.UT == "MAHARASHTRA"), which(sao$State.UT == "GOA"))
sao = add_row_entries_sao(sao, which(sao$State.UT == "GUJARAT"), which(sao$State.UT == "D&N HAVELI"))
sao = add_row_entries_sao(sao, which(sao$State.UT == "GUJARAT"), which(sao$State.UT == "DAMAN & DIU"))
sao = add_row_entries_sao(sao, which(sao$State.UT == "MEGHALAYA"), which(sao$State.UT == "MIZORAM"))
sao = add_row_entries_sao(sao, which(sao$State.UT == "MEGHALAYA"), which(sao$State.UT == "TRIPURA"))
sao = add_row_entries_sao(sao, which(sao$State.UT == "NAGALAND"), which(sao$State.UT == "MANIPUR"))
sao = inner_join(sao, fci_do_count, by=c("State.UT"))
return (sao)
}
fci_do_count = read.xlsx("FCI District Office Count.xlsx")
sao <- make_district_office_count(state_total_ao, fci_do_count)
sao$ao_gap = sao$allotment - sao$offtake
sao$utilisation_ratio = sao$offtake / sao$allotment
sao <- remove_outliers(sao, c("utilisation_ratio", "do_count"))
#DCP Analysis
rice$grain = "rice"
wheat$grain = "wheat"
df_dcp = rbind(rice, wheat)
rice$grain = wheat$grain = NULL
df_dcp$dcp = 0
dcp_status <- read.xlsx("DCP Status.xlsx")
dcp_status = dcp_status[complete.cases(dcp_status),]
#wef - with effect from. The year from which dcp is with effect
for(i in 1:dim(dcp_status)[1])
{
year = dcp_status[i, ]$wef
state = dcp_status[i, ]$State.UT
grain = dcp_status[i, ]$grain
idxs = which(df_dcp$year >= year & df_dcp$State.UT == state & df_dcp$grain == grain)
df_dcp[idxs, ]$dcp = 1
}
df_dcp$utilisation_ratio = df_dcp$offtake / df_dcp$allotment
df_dcp <- df_dcp[complete.cases(df_dcp), ]
df_dcp <- df_dcp[is.finite(df_dcp$utilisation_ratio),]
df_dcp <- df_dcp[which(df_dcp$utilisation_ratio <= 1), ]
df_dcp <- remove_outliers(df_dcp, c("utilisation_ratio"))
#Reading population data
pop <- read.xlsx("projected_population_by_state_2012_2036.xlsx")
pop$log_pop = log(pop$Population)
#Reading BPL Population data
bpl_perc2011 <- read.xlsx('BPL data.xlsx')
names(bpl_perc2011)[2] = "percent"
bpl_perc2011$year = 2011
#Gathering infant mortality rate
inf_mr <- read.xlsx("state wise infant mortality rate.xlsx")
inf_mr$year = as.numeric(inf_mr$year)
r = rice
w = wheat
r$zone = r$offtake = w$offtake = w$zone = NULL
names(r)[which(names(r) == "allotment")] = "rice_allotment"
names(r)
names(w)[which(names(w) == "allotment")] = "wheat_allotment"
names(w)
rw = inner_join(r, w, by=c('State.UT', 'year'))
View(rw)
rw$rice_perc = rw$rice_allotment / (rw$rice_allotment + rw$wheat_allotment)
rw$wheat_perc = rw$wheat_allotment / (rw$wheat_allotment + rw$rice_allotment)
years = unique(rw$year)
years
year = 2006
past_years = c(year - 3 : year - 1)
past_years
year
year - 3
year - 1
c(2003:2005)
c((year - 3):(year - 1))
c((year - 3:year - 1))
past_years %in% rw$year
state = "TELANGANA"
state = "TELANGANA"
year = 2016
past_years = c((year - 3): (year - 1))
which(state %in% rw$State.UT & past_years %in% rw$year)
state = "TELANGANA"
year = 2016
which(state %in% rw$State.UT & past_years %in% rw$year)
rw[which(state %in% rw$State.UT & past_years %in% rw$year),]
state = "TELANGANA"
year = 2016
past_years = c((year - 3): (year - 1))
rw[which(state %in% rw$State.UT & past_years %in% rw$year),]
rw[which(state %in% rw$State.UT ),]
state %in% rw$State.UT
rw$State.UT
rw[state %in% rw$State.UT ,]
state = "TELANGANA"
year = 2016
rw[(state %in% rw$State.UT) & (year %in% rw$year),]
rw[c(10, 11, 12),]
rw[c(10, 11, 12),]$rice_perc
mean(rw[c(10, 11, 12),]$rice_perc)
rw$rice_moving_perc = rw$wheat_moving_perc = 0
for(year in c(2006:2019))
{
past_years = c((year - 3): (year - 1))
for(state in unique(rw$State.UT))
{
idx1 = which(rw$State.UT == state & rw$year == past_years[1])
idx2 = which(rw$State.UT == state & rw$year == past_years[2])
idx3 = which(rw$State.UT == state & rw$year == past_years[3])
if(length(idx1) > 0 & length(idx2) > 0 & length(idx3) > 0)
{
rw$rice_moving_perc = mean(rw[c(idx1, idx2, idx3),]$rice_perc)
rw$wheat_moving_perc = mean(rw[c(idx1, idx2, idx3),]$wheat_perc)
}
else
{
rw$rice_moving_perc = 0
rw$wheat_moving_perc = 0
}
}
}
for(year in c(2006:2019))
rw$rice_moving_perc = rw$wheat_moving_perc = 0
for(year in c(2006:2019))
{
past_years = c((year - 3): (year - 1))
for(state in unique(rw$State.UT))
{
idx1 = which(rw$State.UT == state & rw$year == past_years[1])
idx2 = which(rw$State.UT == state & rw$year == past_years[2])
idx3 = which(rw$State.UT == state & rw$year == past_years[3])
if(length(idx1) > 0 & length(idx2) > 0 & length(idx3) > 0)
{
rw$rice_moving_perc = mean(rw[c(idx1, idx2, idx3),]$rice_perc)
rw$wheat_moving_perc = mean(rw[c(idx1, idx2, idx3),]$wheat_perc)
}
else
{
rw$rice_moving_perc = 0
rw$wheat_moving_perc = 0
}
}
}
year = 2007
state = "TAMILNADU"
past_years = c((year - 3): (year - 1))
idx1 = which(rw$State.UT == state & rw$year == past_years[1])
past_years[1]
year = 2007
past_years = c((year - 3): (year - 1))
idx1 = which(rw$State.UT == state & rw$year == past_years[1])
idx2 = which(rw$State.UT == state & rw$year == past_years[2])
idx3 = which(rw$State.UT == state & rw$year == past_years[3])
state = "A&N ISLANDS"
idx1 = which(rw$State.UT == state & rw$year == past_years[1])
idx2 = which(rw$State.UT == state & rw$year == past_years[2])
idx3 = which(rw$State.UT == state & rw$year == past_years[3])
rw$rice_moving_perc = mean(rw[c(idx1, idx2, idx3),]$rice_perc)
rice <- read.xlsx("rice.xlsx")
wheat <- read.xlsx("wheat.xlsx")
View(rice)
View(wheat)
r = rice
w = wheat
r$zone = r$offtake = w$offtake = w$zone = NULL
names(r)[which(names(r) == "allotment")] = "rice_allotment"
names(r)
names(w)[which(names(w) == "allotment")] = "wheat_allotment"
names(w)
rw = inner_join(r, w, by=c('State.UT', 'year'))
View(rw)
rw$rice_perc = rw$rice_allotment / (rw$rice_allotment + rw$wheat_allotment)
rw$wheat_perc = rw$wheat_allotment / (rw$wheat_allotment + rw$rice_allotment)
rw$rice_moving_perc = rw$wheat_moving_perc = 0
year = 2007
past_years = c((year - 3): (year - 1))
year = 2007
state = "A&N ISLANDS"
past_years = c((year - 3): (year - 1))
idx1 = which(rw$State.UT == state & rw$year == past_years[1])
idx2 = which(rw$State.UT == state & rw$year == past_years[2])
idx3 = which(rw$State.UT == state & rw$year == past_years[3])
idx4 = which(rw$State.UT == state & rw$year == year)
if(length(idx1) > 0 & length(idx2) > 0 & length(idx3) > 0 & length(idx4) > 0)
{
rw[idx4, ]$rice_moving_perc = mean(rw[c(idx1, idx2, idx3),]$rice_perc)
rw[idx4, ]$wheat_moving_perc = mean(rw[c(idx1, idx2, idx3),]$wheat_perc)
}
for(year in c(2006:2019))
{
past_years = c((year - 3): (year - 1))
for(state in unique(rw$State.UT))
{
idx1 = which(rw$State.UT == state & rw$year == past_years[1])
idx2 = which(rw$State.UT == state & rw$year == past_years[2])
idx3 = which(rw$State.UT == state & rw$year == past_years[3])
idx4 = which(rw$State.UT == state & rw$year == year)
if(length(idx1) > 0 & length(idx2) > 0 & length(idx3) > 0 & length(idx4) > 0)
{
rw[idx4, ]$rice_moving_perc = mean(rw[c(idx1, idx2, idx3),]$rice_perc)
rw[idx4, ]$wheat_moving_perc = mean(rw[c(idx1, idx2, idx3),]$wheat_perc)
}
else
{
rw$rice_moving_perc = 0
rw$wheat_moving_perc = 0
}
}
}
for(year in c(2006:2019))
{
past_years = c((year - 3): (year - 1))
for(state in unique(rw$State.UT))
{
idx1 = which(rw$State.UT == state & rw$year == past_years[1])
idx2 = which(rw$State.UT == state & rw$year == past_years[2])
idx3 = which(rw$State.UT == state & rw$year == past_years[3])
idx4 = which(rw$State.UT == state & rw$year == year)
if(length(idx1) > 0 & length(idx2) > 0 & length(idx3) > 0 & length(idx4) > 0)
{
rw[idx4, ]$rice_moving_perc = mean(rw[c(idx1, idx2, idx3),]$rice_perc)
rw[idx4, ]$wheat_moving_perc = mean(rw[c(idx1, idx2, idx3),]$wheat_perc)
}
}
}
(0.0174 + 0.0204 + 0.214) / 3
(0.01745967 + 0.02047885 + 0.02142297)/3
rw = rw[which(rw$wheat_moving_perc > 0 & rw$rice_moving_perc > 0),]
rw = inner_join(r, w, by=c('State.UT', 'year'))
rw = inner_join(r, w, by=c('State.UT', 'year'))
View(rw)
rw$rice_perc = rw$rice_allotment / (rw$rice_allotment + rw$wheat_allotment)
rw$wheat_perc = rw$wheat_allotment / (rw$wheat_allotment + rw$rice_allotment)
rw$rice_moving_perc = rw$wheat_moving_perc = 0
year = 2007
for(year in c(2006:2019))
{
past_years = c((year - 3): (year - 1))
for(state in unique(rw$State.UT))
{
idx1 = which(rw$State.UT == state & rw$year == past_years[1])
idx2 = which(rw$State.UT == state & rw$year == past_years[2])
idx3 = which(rw$State.UT == state & rw$year == past_years[3])
idx4 = which(rw$State.UT == state & rw$year == year)
if(length(idx1) > 0 & length(idx2) > 0 & length(idx3) > 0 & length(idx4) > 0)
{
rw[idx4, ]$rice_moving_perc = mean(rw[c(idx1, idx2, idx3),]$rice_perc)
rw[idx4, ]$wheat_moving_perc = mean(rw[c(idx1, idx2, idx3),]$wheat_perc)
}
}
}
rw = rw[which(rw$wheat_moving_perc > 0 & rw$rice_moving_perc > 0),]
#Rice with population
rwp = inner_join(rw, pop, by=c('State.UT', 'year'))
View(rwp)
fit <- lm(rice_allotment ~ Population + rice_moving_perc + wheat_moving_perc, rwp)
summary(fit)$r.squared
fit <- lm(rice_allotment ~ Population, rwp)
summary(fit)$r.squared
bpl_change_rate = c()
ssr = c()
for(bpl_cr in seq(-1, 3, 0.05))
{
bpl = generate_bpl_data(pop, bpl_perc2011, bpl_cr)
rsp = inner_join(bpl, rw, on=c("State.UT", "year"))
fit <- lm(rsp$rice_allotment ~ rsp$bpl_pop)
ssr_ = sum(fit$residuals ^ 2)
bpl_change_rate = c(bpl_change_rate, bpl_cr)
ssr = c(ssr, ssr_)
}
bpl_cr = bpl_change_rate[which(ssr == min(ssr))]
bpl = generate_bpl_data(pop, bpl_perc2011, bpl_cr)
rsp = inner_join(bpl, rw, on=c("State.UT", "year"))
View(rsp)
fit <- lm(rice_allotment ~ bpl_pop + rice_moving_perc + wheat_moving_perc, rsp)
summary(fit)$r.squared
fit <- lm(rice_allotment ~ bpl_pop + rice_perc + wheat_perc, rsp)
summary(fit)$r.squared
bpl_cr = bpl_change_rate[which(ssr == min(ssr))]
fit <- lm(rice_allotment ~ bpl_pop, rsp)
summary(fit)$r.squared
fit <- lm(rice_allotment ~ bpl_pop + rice_perc + wheat_perc, rsp)
summary(fit)$r.squared
bpl_change_rate = c()
ssr = c()
for(bpl_cr in seq(-1, 3, 0.05))
{
bpl = generate_bpl_data(pop, bpl_perc2011, bpl_cr)
rsp = inner_join(bpl, rw, on=c("State.UT", "year"))
fit <- lm(rsp$rice_allotment ~ rsp$bpl_pop)
ssr_ = sum(fit$residuals ^ 2)
bpl_change_rate = c(bpl_change_rate, bpl_cr)
ssr = c(ssr, ssr_)
}
bpl_cr = bpl_change_rate[which(ssr == min(ssr))]
bpl = generate_bpl_data(pop, bpl_perc2011, bpl_cr)
rsp = inner_join(bpl, rw, on=c("State.UT", "year"))
bpl = generate_bpl_data(pop, bpl_perc2011, bpl_cr)
rsp = inner_join(bpl, rw, on=c("State.UT", "year"))
bpl_change_rate = c()
ssr = c()
for(bpl_cr in seq(-1, 3, 0.05))
{
bpl = generate_bpl_data(pop, bpl_perc2011, bpl_cr)
rsp = inner_join(bpl, rw, on=c("State.UT", "year"))
fit <- lm(rsp$wheat_allotment ~ rsp$bpl_pop)
ssr_ = sum(fit$residuals ^ 2)
bpl_change_rate = c(bpl_change_rate, bpl_cr)
ssr = c(ssr, ssr_)
}
wheat_bpl_cr = bpl_change_rate[which(ssr == min(ssr))]
bpl = generate_bpl_data(pop, bpl_perc2011, bpl_cr)
rsp = inner_join(bpl, rw, on=c("State.UT", "year"))
fit <- lm(wheat_allotment ~ bpl_pop + rice_perc + wheat_perc, rsp)
summary(fit)$r.squared
fit <- lm(wheat_allotment ~ bpl_pop + rice_moving_perc + wheat_moving_perc, rsp)
summary(fit)$r.squared
r = rice
w = wheat
r$zone = r$offtake = w$offtake = w$zone = NULL
names(r)[which(names(r) == "allotment")] = "rice_allotment"
names(r)
names(w)[which(names(w) == "allotment")] = "wheat_allotment"
names(w)
rw = inner_join(r, w, by=c('State.UT', 'year'))
rw$rice_perc = rw$rice_allotment / (rw$rice_allotment + rw$wheat_allotment)
rw$wheat_perc = rw$wheat_allotment / (rw$wheat_allotment + rw$rice_allotment)
rw$rice_moving_perc = rw$wheat_moving_perc = 0
for(year in c(2006:2019))
{
past_years = c((year - 3): (year - 1))
for(state in unique(rw$State.UT))
{
idx1 = which(rw$State.UT == state & rw$year == past_years[1])
idx2 = which(rw$State.UT == state & rw$year == past_years[2])
idx3 = which(rw$State.UT == state & rw$year == past_years[3])
idx4 = which(rw$State.UT == state & rw$year == year)
if(length(idx1) > 0 & length(idx2) > 0 & length(idx3) > 0 & length(idx4) > 0)
{
rw[idx4, ]$rice_moving_perc = mean(rw[c(idx1, idx2, idx3),]$rice_perc)
rw[idx4, ]$wheat_moving_perc = mean(rw[c(idx1, idx2, idx3),]$wheat_perc)
}
}
}
rw = rw[which(rw$wheat_moving_perc > 0 & rw$rice_moving_perc > 0),]
#Rice allotment with population, percentage taken as moving average of past 3 years
rwp = inner_join(rw, pop, by=c('State.UT', 'year'))
fit <- lm(rice_allotment ~ Population + rice_moving_perc + wheat_moving_perc, rwp)
summary(fit)$r.squared
#Wheat allotment with population, percentage taken as moving average of past 3 years
fit <- lm(wheat_allotment ~ Population + rice_moving_perc + wheat_moving_perc, rwp)
summary(fit)$r.squared
#Rice allotment with population, percentage taken for current year (Incorrect modelling)
fit <- lm(rice_allotment ~ Population + rice_perc + wheat_perc, rwp)
summary(fit)$r.squared
#Rice allotment with population, percentage taken as moving average of past 3 years
fit <- lm(rice_allotment ~ Population + rice_moving_perc + wheat_moving_perc, rwp)
summary(fit)$r.squared
bpl_change_rate = c()
ssr = c()
for(bpl_cr in seq(-1, 3, 0.05))
{
bpl = generate_bpl_data(pop, bpl_perc2011, bpl_cr)
rsp = inner_join(bpl, rw, on=c("State.UT", "year"))
fit <- lm(rsp$rice_allotment ~ rsp$bpl_pop)
ssr_ = sum(fit$residuals ^ 2)
bpl_change_rate = c(bpl_change_rate, bpl_cr)
ssr = c(ssr, ssr_)
}
rice_bpl_cr = bpl_change_rate[which(ssr == min(ssr))]
bpl = generate_bpl_data(pop, bpl_perc2011, bpl_cr)
rsp = inner_join(rice_bpl_cr, rw, on=c("State.UT", "year"))
bpl = generate_bpl_data(pop, bpl_perc2011, rice_bpl_cr)
rsp = inner_join(bpl, rw, on=c("State.UT", "year"))
fit <- lm(rice_allotment ~ bpl_pop + rice_perc + wheat_perc, rsp)
summary(fit)$r.squared
fit <- lm(rice_allotment ~ bpl_pop + rice_moving_perc + wheat_moving_perc, rsp)
summary(fit)$r.squared
bpl_change_rate = c()
ssr = c()
for(bpl_cr in seq(-1, 3, 0.05))
{
bpl = generate_bpl_data(pop, bpl_perc2011, bpl_cr)
rsp = inner_join(bpl, rw, on=c("State.UT", "year"))
fit <- lm(rsp$wheat_allotment ~ rsp$bpl_pop)
ssr_ = sum(fit$residuals ^ 2)
bpl_change_rate = c(bpl_change_rate, bpl_cr)
ssr = c(ssr, ssr_)
}
wheat_bpl_cr = bpl_change_rate[which(ssr == min(ssr))]
bpl = generate_bpl_data(pop, bpl_perc2011, wheat_bpl_cr)
rsp = inner_join(bpl, rw, on=c("State.UT", "year"))
#Wheat allotment with population, percentage taken as moving average of past 3 years
fit <- lm(wheat_allotment ~ Population + rice_moving_perc + wheat_moving_perc, rwp)
summary(fit)$r.squared
#Wheat allotment with population, percentage taken as moving average of past 3 years
fit <- lm(wheat_allotment ~ Population + rice_moving_perc + wheat_moving_perc, rwp)
summary(fit)$r.squared
bpl = generate_bpl_data(pop, bpl_perc2011, wheat_bpl_cr)
rwp = inner_join(bpl, rw, on=c("State.UT", "year"))
#Wheat allotment with population, percentage as current years (Incorrect modelling)
fit <- lm(wheat_allotment ~ Population + rice_perc + wheat_perc, rwp)
summary(fit)$r.squared
#Wheat allotment with population, percentage as past 3 years moving average
fit <- lm(wheat_allotment ~ Population + rice_perc + wheat_perc, rwp)
#Wheat allotment with population, percentage as past 3 years moving average
fit <- lm(wheat_allotment ~ Population + rice_perc + wheat_perc, rwp)
summary(fit)$r.squared
#Wheat allotment with population, percentage as past 3 years moving average
fit <- lm(wheat_allotment ~ Population + rice_moving_perc + wheat_moving_perc, rwp)
summary(fit)$r.squared
#Wheat allotment with population, percentage as current years (Incorrect modelling)
fit <- lm(wheat_allotment ~ Population + rice_perc + wheat_perc, rwp)
summary(fit)$r.squared
#Wheat allotment with population, percentage as past 3 years moving average
fit <- lm(wheat_allotment ~ Population + rice_moving_perc + wheat_moving_perc, rwp)
summary(fit)$r.squared
#Wheat allotment with population, percentage as current years (Incorrect modelling)
fit <- lm(wheat_allotment ~ Population + rice_perc + wheat_perc, rwp)
summary(fit)$r.squared
#Wheat allotment with population, percentage as past 3 years moving average
fit <- lm(wheat_allotment ~ Population + rice_moving_perc + wheat_moving_perc, rwp)
summary(fit)$r.squared
#Wheat allotment with population, percentage taken as moving average of past 3 years
fit <- lm(wheat_allotment ~ bpl_pop + rice_moving_perc + wheat_moving_perc, rwp)
summary(fit)$r.squared
fit <- lm(wheat_allotment ~ bpl_pop + rice_perc + wheat_perc, rwp)
summary(fit)$r.squared
#Wheat allotment with population, percentage taken as moving average of past 3 years
fit <- lm(wheat_allotment ~ bpl_pop + rice_moving_perc + wheat_moving_perc, rwp)
summary(fit)$r.squared
quit()
